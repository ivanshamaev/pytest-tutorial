# üìö –ì–ª–æ—Å—Å–∞—Ä–∏–π pytest –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏ pytest.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### **–¢–µ—Å—Ç (Test)**
–§—É–Ω–∫—Ü–∏—è –∏–ª–∏ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç, —á—Ç–æ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ. 
```python
def test_add_task():  # –≠—Ç–æ —Ç–µ—Å—Ç
    app = TodoApp()
    task = app.add_task("Learn pytest")
    assert task.title == "Learn pytest"
```

### **Assertion**
–ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —á—Ç–æ-—Ç–æ –≤–µ—Ä–Ω–æ. –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ ‚Äî —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç.
```python
assert task.title == "Learn pytest"  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
assert task.done is False             # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–¥–∞—á–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
```

### **Test Suite (–ù–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤)**
–ì—Ä—É–ø–ø–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, —á–∞—Å—Ç–æ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ.
```bash
pytest test/test_todo_app.py  # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –≤ —Ñ–∞–π–ª–µ
```

### **Test Case (–¢–µ—Å—Ç–æ–≤—ã–π —Å–ª—É—á–∞–π)**
–û–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
- –ü—Ä–∏–º–µ—Ä: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—É—Å—Ç–æ–π –∑–∞–¥–∞—á–∏ –¥–æ–ª–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É"

---

## pytest —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞

### **Fixture**
–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–∞. –ö–∞–∫ "–Ω–∞—á–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è".
```python
@pytest.fixture
def todo_app(tmp_path):
    """Fixture –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–≤–µ–∂–∏–π –æ–±—ä–µ–∫—Ç TodoApp –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞"""
    return TodoApp(tmp_path / "tasks.json")

def test_add_task(todo_app):  # todo_app ‚Äî —ç—Ç–æ fixture
    task = todo_app.add_task("Learn pytest")
    assert task.title == "Learn pytest"
```

**Scope (–û–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è) Fixture:**
- `function` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `class` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –∫–ª–∞—Å—Å–∞ —Ç–µ—Å—Ç–æ–≤
- `module` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –º–æ–¥—É–ª—è
- `session` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –≤—Å–µ–π —Å–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **Parametrize (–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è)**
–ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
```python
@pytest.mark.parametrize("priority,expected", [
    (1, 1),
    (2, 2),
    (3, 3),
])
def test_priority(priority, expected):
    # –¢–µ—Å—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è 3 —Ä–∞–∑–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    assert priority == expected
```

### **Mark (–ú–∞—Ä–∫–µ—Ä)**
–ú–µ—Ç–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤, —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å.
```python
@pytest.mark.critical        # –ö—Ä–∏—Ç–∏—á–Ω—ã–π —Ç–µ—Å—Ç
@pytest.mark.slow            # –ú–µ–¥–ª–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç
@pytest.mark.integration     # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç
def test_something():
    pass

# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤:
# pytest -m "critical"
```

### **conftest.py**
–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª pytest, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –æ–±—â–∏–µ fixtures –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è pytest
- –°–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ fixtures –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

---

## –¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **Failing Test (–ü–∞–¥–∞—é—â–∏–π —Ç–µ—Å—Ç)**
–¢–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø—Ä–æ—à—ë–ª, –ø–æ—Ç–æ–º—É —á—Ç–æ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è.
```
FAILED test_add_task - assert "Wrong" == "Learn pytest"
```

### **Passing Test (–ü—Ä–æ—Ö–æ–¥—è—â–∏–π —Ç–µ—Å—Ç)**
–¢–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ ‚Äî –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω—É–∂–Ω–æ.
```
PASSED test_add_task
```

### **Exception/Error (–ò—Å–∫–ª—é—á–µ–Ω–∏–µ/–û—à–∏–±–∫–∞)**
–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞.
```python
with pytest.raises(ValueError):  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞
    app.add_task("")
```

### **Mock/Patch (–ü–æ–¥–¥–µ–ª–∫–∞/–ó–∞–º–µ–Ω–∞)**
–ó–∞–º–µ–Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –ø–æ–¥–¥–µ–ª—å–Ω—ã–π –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤.
```python
from unittest.mock import patch

@patch('requests.get')  # –ó–∞–º–µ–Ω—è–µ–º –Ω–∞—Å—Ç–æ—è—â–∏–π –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥–¥–µ–ª—å–Ω—ã–π
def test_api_call(mock_get):
    # –¢–µ—Å—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
    pass
```

---

## –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### **Unit Test (–ú–æ–¥—É–ª—å–Ω—ã–π —Ç–µ—Å—Ç)**
–¢–µ—Å—Ç –æ–¥–Ω–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –∫—É—Å–∫–∞ –∫–æ–¥–∞ (—Ñ—É–Ω–∫—Ü–∏—è, –º–µ—Ç–æ–¥).
```python
def test_add_task_basic():  # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –º–µ—Ç–æ–¥ add_task()
    app = TodoApp()
    task = app.add_task("Learn pytest")
    assert task.title == "Learn pytest"
```

### **Integration Test (–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç)**
–¢–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ.
```python
@pytest.mark.integration
def test_complete_workflow():
    app = TodoApp()
    app.add_task("Task 1")
    app.add_task("Task 2")
    app.complete_task("Task 1")
    assert app.completed_tasks_count() == 1
```

### **Edge Case (–ì—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π)**
–¢–µ—Å—Ç –æ—Å–æ–±—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π (–ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Ç.–¥.).
```python
def test_empty_title():  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –≥—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π
    with pytest.raises(ValueError):
        app.add_task("")

def test_very_long_title():  # –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
    with pytest.raises(ValueError):
        app.add_task("x" * 1000)
```

---

## –ö–æ–º–∞–Ω–¥—ã pytest

| –ö–æ–º–∞–Ω–¥–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|---------|-----------|
| `pytest` | –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã |
| `pytest -v` | –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º |
| `pytest -x` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ |
| `pytest -k "add"` | –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã —Å "add" –≤ –∏–º–µ–Ω–∏ |
| `pytest -m "critical"` | –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º "critical" |
| `pytest --collect-only` | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –±–µ–∑ –∏—Ö –∑–∞–ø—É—Å–∫–∞ |
| `pytest --markers` | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã |

---

## –í–∞–∂–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### **DRY (Don't Repeat Yourself)**
–ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –∫–æ–¥. –ò—Å–ø–æ–ª—å–∑—É–π fixtures –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–¥ –ø–∏—Å–∞—Ç—å –≤ –∫–∞–∂–¥–æ–º —Ç–µ—Å—Ç–µ.

### **AAA Pattern (Arrange-Act-Assert)**
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö–æ—Ä–æ—à–µ–≥–æ —Ç–µ—Å—Ç–∞:
1. **Arrange** ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2. **Act** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
3. **Assert** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```python
def test_add_task():
    # Arrange
    app = TodoApp()
    
    # Act
    task = app.add_task("Learn pytest")
    
    # Assert
    assert task.title == "Learn pytest"
```

### **Isolation (–ò–∑–æ–ª—è—Ü–∏—è)**
–ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º –∏ –Ω–µ –≤–ª–∏—è—Ç—å –Ω–∞ –¥—Ä—É–≥–∏–µ —Ç–µ—Å—Ç—ã.
- –ò—Å–ø–æ–ª—å–∑—É–π fixtures –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∏—Å—Ç—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–π –æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏

### **Coverage (–ü–æ–∫—Ä—ã—Ç–∏–µ)**
–ü—Ä–æ—Ü–µ–Ω—Ç –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–µ—Å—Ç—ã.
```bash
pytest --cov=src test/  # –ü–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –∫–æ–¥–∞ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ

- **README.md** ‚Äî –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- **PYTEST_EXAMPLES.md** ‚Äî –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **PYTEST_PATTERNS.md** ‚Äî –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **test/test_todo_app.py** ‚Äî —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤
- **test/conftest.py** ‚Äî fixtures –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

---

## –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö

```python
# –ò–º–ø–æ—Ä—Ç pytest
import pytest

# –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç
def test_something():
    assert 1 + 1 == 2

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fixture
def test_with_fixture(todo_app):
    task = todo_app.add_task("Test")
    assert task is not None

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
def test_error():
    with pytest.raises(ValueError):
        # –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É

# –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä–∫–µ—Ä
@pytest.mark.critical
def test_important():
    pass

# –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å
@pytest.mark.parametrize("a,b,expected", [(1,2,3), (2,3,5)])
def test_math(a, b, expected):
    assert a + b == expected
```

---

**–ü–æ–º–Ω–∏—Ç–µ:** —Ç–µ—Å—Ç—ã ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞, —ç—Ç–æ **–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–æ–≥–æ, –∫–∞–∫ –∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å**! üìö
